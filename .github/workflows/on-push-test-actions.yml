# yaml-language-server: $schema=https://json.schemastore.org/github-workflow.json

# For more information on using and configuring these actions, see:
# https://instantiator.dev/presence/gha/format-and-post-with-gha.html

name: on-push-test-actions
on:
  workflow_dispatch:
  push:
    branches:
      - "main"
    paths:
      - format-thread/**
      - post-thread/**
    
jobs:
  format-simple-thread:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Format sample thread
        id: format-thread
        uses: instantiator/presence/format-thread@main
        with:
          networks: 'Console,AT'
          input-file: 'SampleData/SimpleThread.md'
      - name: Post sample thread to console
        id: post-thread
        uses: instantiator/presence/post-thread@main
        with:
          thread: ${{ steps.format-thread.outputs.format-response }}
          config: "{ \"PRESENCE_ACCOUNTS\": \"TEST0,TEST1\", \"TEST0_CONSOLE_PRINTPREFIX\": \"[TEST0-GHA]\", \"TEST1_AT_ACCOUNTNAME\": \"${{ secrets.TEST1_AT_ACCOUNTNAME }}\", \"TEST1_AT_APPPASSWORD\": \"${{ secrets.TEST1_AT_APPPASSWORD }}\" }"
      - name: Summarise activity
        id: summarise
        run: echo "${{ steps.post-thread.outputs.post-thread-summary }}"
